
#Before running this import, it's CRUCIAL to look at the new data provided by MDH and see what the fields are named
# and what order they appear in. Nearly every year, they change it. 
#in the excel file called "deaths_field_list" you can find a crosswalk I made for the 2016 data to match it 
# to the names we were already using in the database. Also note, I found the death date moved next to the birthdate (previously 
# it had been farther down the file.) So I adjusted the database to reflect that.

#the data usually comes as an Excel file. Need to convert to .csv

#The Injury_dt field comes over as text -- '01-NOV-77' or '11-MAR-16'. This import process brings it in as text and then 
#runs a series of queries to convert it to true date in a separate field, depending if its in the 1900s or 2000s

#This script has 5 sections
#First is simply importing the file into "deaths_original" 
#Second is cleanup, such as adding a bunch of fields, converting that injury date, trimming name fields, etc. 
#Third is splitting fields out to the separate tables -- deaths_main, deaths_other, deaths_race and deaths_icd.
#fourth section updates the inventory table 
#fifth section makes a temp table with the most current year for moving it to Uniquery (need to update that query)

#The deaths_main table is the only one used for Uniquery

#here are the indexes that are already in the table; will only need to use these again
#if the Deaths_original table is deleted and needs to be recreated

create index idx_st_file_nbr on Deaths_original(st_file_nbr);
create index idx_SUBJECT_NOT_HISPANIC on Deaths_original(SUBJECT_NOT_HISPANIC);
create index idx_SUBJECT_MEXICAN on Deaths_original(SUBJECT_MEXICAN);
create index idx_SUBJECT_PUERTO_RICAN on Deaths_original(SUBJECT_PUERTO_RICAN);
create index idx_SUBJECT_CUBAN on Deaths_original(SUBJECT_CUBAN);
create index idx_SUBJECT_OTHER_SPANISH on Deaths_original(SUBJECT_OTHER_SPANISH);
create index idx_SUBJECT_OTHR_SPAN_TXT on Deaths_original(SUBJECT_OTHR_SPAN_TXT);
create index idx_SUBJECT_REFUSED_HISPANIC on Deaths_original(SUBJECT_REFUSED_HISPANIC);
create index idx_SUBJECT_UNKNOWN_HISPANIC on Deaths_original(SUBJECT_UNKNOWN_HISPANIC);
create index idx_SUBJECT_NOTOBTAINABLE_HISPANIC on Deaths_original(SUBJECT_NOTOBTAINABLE_HISPANIC);
create index idx_SUBJECT_WHITE on Deaths_original(SUBJECT_WHITE);
create index idx_SUBJECT_AFRICAN_AMERICAN on Deaths_original(SUBJECT_AFRICAN_AMERICAN);
create index idx_SUBJECT_SOMALI on Deaths_original(SUBJECT_SOMALI);
create index idx_SUBJECT_ETHIOPIAN on Deaths_original(SUBJECT_ETHIOPIAN);
create index idx_SUBJECT_LIBERIAN on Deaths_original(SUBJECT_LIBERIAN);
create index idx_SUBJECT_KENYAN on Deaths_original(SUBJECT_KENYAN);
create index idx_SUBJECT_SUDANESE on Deaths_original(SUBJECT_SUDANESE);
create index idx_SUBJECT_NIGERIAN on Deaths_original(SUBJECT_NIGERIAN);
create index idx_SUBJECT_GHANIAN on Deaths_original(SUBJECT_GHANIAN);
create index idx_SUBJECT_OTHER_AFRICAN on Deaths_original(SUBJECT_OTHER_AFRICAN);
create index idx_SUBJECT_OTHER_AFRICAN_TXT on Deaths_original(SUBJECT_OTHER_AFRICAN_TXT);
create index idx_SUBJECT_AMERICAN_INDIAN on Deaths_original(SUBJECT_AMERICAN_INDIAN);
create index idx_SUBJECT_TRIBE_TXT1 on Deaths_original(SUBJECT_TRIBE_TXT1);
create index idx_SUBJECT_TRIBE_TXT2 on Deaths_original(SUBJECT_TRIBE_TXT2);
create index idx_SUBJECT_ASIAN_INDIAN on Deaths_original(SUBJECT_ASIAN_INDIAN);
create index idx_SUBJECT_CHINESE on Deaths_original(SUBJECT_CHINESE);
create index idx_SUBJECT_FILIPINO on Deaths_original(SUBJECT_FILIPINO);
create index idx_SUBJECT_JAPANESE on Deaths_original(SUBJECT_JAPANESE);
create index idx_SUBJECT_KOREAN on Deaths_original(SUBJECT_KOREAN);
create index idx_SUBJECT_VIETNAMESE on Deaths_original(SUBJECT_VIETNAMESE);
create index idx_SUBJECT_HMONG on Deaths_original(SUBJECT_HMONG);
create index idx_SUBJECT_CAMBODIAN on Deaths_original(SUBJECT_CAMBODIAN);
create index idx_SUBJECT_LAOTIAN on Deaths_original(SUBJECT_LAOTIAN);
create index idx_SUBJECT_OTHER_ASIAN on Deaths_original(SUBJECT_OTHER_ASIAN);
create index idx_SUBJECT_OTHR_ASN_TXT1 on Deaths_original(SUBJECT_OTHR_ASN_TXT1);
create index idx_SUBJECT_OTHR_ASN_TXT2 on Deaths_original(SUBJECT_OTHR_ASN_TXT2);
create index idx_SUBJECT_HAWAIIAN on Deaths_original(SUBJECT_HAWAIIAN);
create index idx_SUBJECT_GUAMANIAN_CHAMORRO on Deaths_original(SUBJECT_GUAMANIAN_CHAMORRO);
create index idx_SUBJECT_SAMOAN on Deaths_original(SUBJECT_SAMOAN);
create index idx_SUBJECT_OTHER_PACIFIC_ISLANDER on Deaths_original(SUBJECT_OTHER_PACIFIC_ISLANDER);
create index idx_SUBJECT_OTHR_PAC_ISLE_TXT1 on Deaths_original(SUBJECT_OTHR_PAC_ISLE_TXT1);
create index idx_SUBJECT_OTHR_PAC_ISLE_TXT2 on Deaths_original(SUBJECT_OTHR_PAC_ISLE_TXT2);
create index idx_SUBJECT_OTHER on Deaths_original(SUBJECT_OTHER);
create index idx_SUBJECT_OTHR_TXT1 on Deaths_original(SUBJECT_OTHR_TXT1);
create index idx_SUBJECT_OTHR_TXT2 on Deaths_original(SUBJECT_OTHR_TXT2);
create index idx_SUBJECT_REFUSED_RACE on Deaths_original(SUBJECT_REFUSED_RACE);
create index idx_SUBJECT_UNKNOWN on Deaths_original(SUBJECT_UNKNOWN);
create index idx_SUBJECT_NOTOBTAINABLE_RACE on Deaths_original(SUBJECT_NOTOBTAINABLE_RACE);
create index idx_injdate on Deaths_original(injury_dt_txt);



###########################################################
####SECTION 1 #############################################################

#update the file name in the load data 


delete from Deaths_original;

LOAD DATA LOCAL INFILE 'W:\\Uniquery_PANDA\\VitalRecords\\deaths\\deathdata2017.csv' into table Deaths_original fields terminated by ',' enclosed by '"' lines terminated by '\r\n' ignore 1 lines
(@ST_FILE_NBR,
@DECD_FRST_NME,
@DECD_MIDD_NME,
@DECD_LST_NME,
@DECD_MAIDN_NME,
@DECD_SUFX,
@ALIAS_FRST_NME,
@ALIAS_MIDD_NME,
@ALIAS_LST_NME,
@ALIAS_SUFX,
@DECD_SEX,
@DECD_AGE_TYPE,
@DECD_AGE_YR,
@DECD_AGE_MON,
@DECD_AGE_DAY,
@DECD_AGE_HR,
@DECD_AGE_MIN,
@DECD_BRTH_DT,
@DECD_DTH_DT,
@DECD_BRTH_CNTRY,
@DECD_BRTH_CNTRY_FIPS_CD,
@DECD_BRTH_ST,
@DECD_BRTH_ST_FIPS_CD,
@DECD_BRTH_CTY,
@DECD_BRTH_CTY_FIPS_CD,
@DECD_RES_NURSING,
@DECD_RES_FCLTY,
@DECD_RES_STRT,
@DECD_RES_MLTIUNIT,
@DECD_RES_CTY,
@DECD_RES_CTY_OTHER,
@DECD_RES_CTY_FIPS_CD,
@DECD_RES_ST,
@DECD_RES_ST_FIPS_CD,
@DECD_RES_ZIP5,
@DECD_RES_ZIP4,
@DECD_RES_CNTRY,
@DECD_RES_CNTRY_OTHER,
@DECD_RES_CNTRY_FIPS_CD,
@DECD_RES_CNTY,
@DECD_RES_CNTY_FIPS_CD,
@DECD_RES_INTL_FL,
@DECD_RES_INTL_CD,
@DECD_RES_CTY_TWNSHP_LIMITS,
@DECD_ARMF_FL,
@DECD_MRTL_STATUS,
@DECD_MRTL_STATUS_CD,
@SPS_FRST_NME,
@SPS_MIDD_NME,
@SPS_LST_NME,
@FTHR_FRST_NME,
@FTHR_MIDD_NME,
@FTHR_LST_NME,
@FTHR_SFX_NME,
@MTHR_FRST_NME,
@MTHR_MIDD_NME,
@MTHR_MAIDN_NME,
@MTHR_SFX_NME,
@IFRMT_TYPE,
@IFRMT_FRST_NME,
@IFRMT_MIDD_NME,
@IFRMT_LST_NME,
@IFRMT_SFX_NME,
@IFRMT_ENTITY,
@IFRMT_RLSHP,
@IFRMT_ADDR_SAME_AS_DECD,
@IFRMT_ADDR_STRT,
@IFRMT_ADDR_MLTIUNIT,
@IFRMT_ADDR_CTY,
@IFRMT_ADDR_CTY_OTHER,
@IFRMT_ADDR_CTY_FIPS_CD,
@IFRMT_ADDR_ST,
@IFRMT_ADDR_ST_FIPS_CD,
@IFRMT_ADDR_CNTRY,
@IFRMT_ADDR_CNTRY_FIPS_CD,
@IFRMT_ADDR_ZIP5,
@IFRMT_ADDR_ZIP4,
@IFRMT_ADDR_INTL_FL,
@IFRMT_ADDR_INTL_CD,
@DECD_PLCE_DTH_TYP,
@DECD_PLCE_DTH_OTHR,
@DECD_PLCE_DTH_TYP_CD,
@DECD_DTH_FCLTY,
@DECD_DTH_FCLTY_ID,
@DECD_DTH_FCLTY_OTHR,
@DECD_DTH_STRT,
@DECD_DTH_MLTIUNIT,
@DECD_DTH_CTY,
@DECD_DTH_CTY_OTHER,
@DECD_DTH_CTY_FIPS_CD,
@DECD_DTH_ST,
@DECD_DTH_ST_FIPS_ALPHA_CD,
@DECD_DTH_CNTRY,
@DECD_DTH_CNTRY_OTHER,
@DECD_DTH_CNTRY_FIPS_CD,
@DECD_DTH_ZIP5,
@DECD_DTH_ZIP4,
@DECD_DTH_INTL_FL,
@DECD_DTH_INTL_CD,
@DECD_DTH_CNTY,
@DECD_DTH_CNTY_FIPS_CD,
@DISP_MTHD_CREM,
@DISP_MTHD_BURIAL,
@DISP_MTHD_DON,
@DISP_MTHD_ENT,
@DISP_MTHD_RMVL_FRM_ST,
@DISP_MTHD_OTHR,
@DISP_MTHD_OTHR_TEXT,
@DISP_MTHD_UNKN,
@DISP_CMTRY_PLCE,
@DISP_CMTRY_PLCE_OTHR,
@DISP_CMTRY_CNTRY,
@DISP_CMTRY_ST,
@DISP_CMTRY_CTY,
@CREM_NME,
@CREM_NME_OTHR,
@CREM_CNTRY,
@CREM_ST,
@CREM_CTY,
@AUTHR_LIC_NBR,
@AUTHR_FRST_NME,
@AUTHR_MIDD_NME,
@AUTHR_LST_NME,
@AUTHR_TITLE,
@INSTITUTION_TYPE,
@FD_FH_ESTAB_NBR,
@FD_FH_NME,
@FD_FH_LOC_STRT,
@FD_FH_LOC_MLTIUNIT,
@FD_FH_LOC_CTY,
@FD_FH_LOC_ST,
@FD_FH_LOC_ST_FIPS_CD,
@FD_FH_LOC_ZIP5,
@FD_FH_LOC_ZIP4,
@FD_FH_LOC_INTL_FL,
@FD_FH_LOC_INTL_CD,
@FD_FH_LOC_CNTRY,
@FD_LIC_NBR,
@FD_FRST_NME,
@FD_MIDD_NME,
@FD_LST_NME,
@FD_SFX_NME,
@DECD_DTH_DT_FOUND,
@DECD_DTH_DT_MODIFIER,
@DECD_DTH_TM,
@DECD_DTH_TIME_INDICATOR,
@DECD_DTH_TIME_FOUND,
@DECD_DTH_TM_MODIFIER,
@ME_CONTACTED,
@CA_DISPOSITION_POSTPONE,
@CA_DISPOSITION_POSTPONE_REASON,
@CA_INJURY_OR_TRAUMA,
@CA_INJURY_OR_TRAUMA_DESCRIBE,
@DT_LAST_SEEN_DAY,
@DT_LAST_SEEN_MONTH,
@DT_LAST_SEEN_YEAR,
@CAUSE_DTH_A,
@CAUSE_INTRVL_A,
@CAUSE_DTH_B,
@CAUSE_INTRVL_B,
@CAUSE_DTH_C,
@CAUSE_INTRVL_C,
@CAUSE_DTH_D,
@CAUSE_INTRVL_D,
@CAUSE_DTH_OTHR,
@ME_AUTPSY,
@ME_AUTPSY_RES_AVLBL,
@TOBACCO_CONTRIBUTED,
@DECD_PREG_DESC,
@DECD_PREG_CD,
@CERTFR_MANNER_DTH,
@CERTFR_MANNER_DTH_CD,
@INJURY_FL,
@INJURY_DT,
@INJURY_DT_CANNOT_DETERMINE,
@INJURY_TM,
@INJURY_TM_CANNOT_DETERMINE,
@INJURY_PLCE_TYP,
@INJURY_WORK,
@INJURY_LOC_STRT,
@INJURY_LOC_MLTIUNIT,
@INJURY_LOC_CTY,
@INJURY_LOC_CTY_OTHER,
@INJURY_LOC_CTY_FIPS_CD,
@INJURY_LOC_ST,
@INJURY_LOC_ST_FIPS_CD,
@INJURY_LOC_CNTRY,
@INJURY_LOC_CNTRY_OTHER,
@INJURY_LOC_CNTRY_FIPS_CD,
@INJURY_LOC_CNTY,
@INJURY_LOC_CNTY_FIPS_CD,
@INJURY_LOC_ZIP5,
@INJURY_LOC_ZIP4,
@INJURY_LOC_INTL_FL,
@INJURY_LOC_INTL_CD,
@INJURY_DESC,
@INJURY_LOC_TRANSPORT,
@INJURY_LOC_TRANSPORT_CD,
@CERTFR_FRST_NME,
@CERTFR_MIDD_NME,
@CERTFR_LST_NME,
@CERTFR_SFX_NME,
@CERTFR_ADDR_STRT,
@CERTFR_ADDR_MLTIUNIT,
@CERTFR_ADDR_CTY,
@CERTFR_ADDR_CTY_OTHER,
@CERTFR_ADDR_CTY_FIPS_CD,
@CERTFR_ADDR_ST,
@CERTFR_ADDR_ST_FIPS_CD,
@CERTFR_ADDR_CNTRY,
@CERTFR_ADDR_CNTRY_OTHER,
@CERTFR_ADDR_CNTRY_FIPS_CD,
@CERTFR_ADDR_ZIP5,
@CERTFR_ADDR_ZIP4,
@CERTFR_ADDR_INTL_FL,
@CERTFR_ADDR_INTL_CD,
@CERTFR_TITLE,
@CERTFR_LIC_NBR,
@CERTFR_NPI_CD,
@DT_FILED_MED,
@DT_FILED_LEGL,
@CMPLT_FL,
@DECD_EDUC,
@DECD_EDUC_CD,
@DECD_OCPTN,
@DECD_IDSTY,
@SUBJECT_NOT_HISPANIC,
@SUBJECT_MEXICAN,
@SUBJECT_PUERTO_RICAN,
@SUBJECT_CUBAN,
@SUBJECT_OTHER_SPANISH,
@SUBJECT_OTHR_SPAN_TXT,
@SUBJECT_REFUSED_HISPANIC,
@SUBJECT_UNKNOWN_HISPANIC,
@SUBJECT_NOTOBTAINABLE_HISPANIC,
@SUBJECT_WHITE,
@SUBJECT_AFRICAN_AMERICAN,
@SUBJECT_SOMALI,
@SUBJECT_ETHIOPIAN,
@SUBJECT_LIBERIAN,
@SUBJECT_KENYAN,
@SUBJECT_SUDANESE,
@SUBJECT_NIGERIAN,
@SUBJECT_GHANIAN,
@SUBJECT_OTHER_AFRICAN,
@SUBJECT_OTHER_AFRICAN_TXT,
@SUBJECT_AMERICAN_INDIAN,
@SUBJECT_TRIBE_TXT1,
@SUBJECT_TRIBE_TXT2,
@SUBJECT_ASIAN_INDIAN,
@SUBJECT_CHINESE,
@SUBJECT_FILIPINO,
@SUBJECT_JAPANESE,
@SUBJECT_KOREAN,
@SUBJECT_VIETNAMESE,
@SUBJECT_HMONG,
@SUBJECT_CAMBODIAN,
@SUBJECT_LAOTIAN,
@SUBJECT_OTHER_ASIAN,
@SUBJECT_OTHR_ASN_TXT1,
@SUBJECT_OTHR_ASN_TXT2,
@SUBJECT_HAWAIIAN,
@SUBJECT_GUAMANIAN_CHAMORRO,
@SUBJECT_SAMOAN,
@SUBJECT_OTHER_PACIFIC_ISLANDER,
@SUBJECT_OTHR_PAC_ISLE_TXT1,
@SUBJECT_OTHR_PAC_ISLE_TXT2,
@SUBJECT_OTHER,
@SUBJECT_OTHR_TXT1,
@SUBJECT_OTHR_TXT2,
@SUBJECT_REFUSED_RACE,
@SUBJECT_UNKNOWN,
@SUBJECT_NOTOBTAINABLE_RACE,
@SUBJECT_RACE_MVR,
@SUBJECT_RACE1E,
@SUBJECT_RACE2E,
@SUBJECT_RACE3E,
@SUBJECT_RACE4E,
@SUBJECT_RACE5E,
@SUBJECT_RACE6E,
@SUBJECT_RACE7E,
@SUBJECT_RACE8E,
@SUBJECT_RACE16C,
@SUBJECT_RACE17C,
@SUBJECT_RACE18C,
@SUBJECT_RACE19C,
@SUBJECT_RACE20C,
@SUBJECT_RACE21C,
@SUBJECT_RACE22C,
@SUBJECT_RACE23C,
@SUBJECT_ETHNICE,
@SUBJECT_ETHNIC5C,
@SUBJECT_RACEBRG,
@RAC_ICD01,
@RAC_CREATED01,
@RAC_ICD02,
@RAC_CREATED02,
@RAC_ICD03,
@RAC_CREATED03,
@RAC_ICD04,
@RAC_CREATED04,
@RAC_ICD05,
@RAC_CREATED05,
@RAC_ICD06,
@RAC_CREATED06,
@RAC_ICD07,
@RAC_CREATED07,
@RAC_ICD08,
@RAC_CREATED08,
@RAC_ICD09,
@RAC_CREATED09,
@RAC_ICD10,
@RAC_CREATED10,
@RAC_ICD11,
@RAC_CREATED11,
@RAC_ICD12,
@RAC_CREATED12,
@RAC_ICD13,
@RAC_CREATED13,
@RAC_ICD14,
@RAC_CREATED14,
@RAC_ICD15,
@RAC_CREATED15,
@RAC_ICD16,
@RAC_CREATED16,
@RAC_ICD17,
@RAC_CREATED17,
@RAC_ICD18,
@RAC_CREATED18,
@RAC_ICD19,
@RAC_CREATED19,
@RAC_ICD20,
@RAC_CREATED20,
@ACME_UNLY_CAUSE_DTH,
@MNL_UNLY_CAUSE_DTH,
@RACE,
@HISPANICETHNICITY,
@INJURY_DATE)
SET
ST_FILE_NBR=@ST_FILE_NBR,
DECD_FRST_NME=@DECD_FRST_NME,
DECD_MIDD_NME=@DECD_MIDD_NME,
DECD_LST_NME=@DECD_LST_NME,
DECD_MAIDN_NME=@DECD_MAIDN_NME,
DECD_SUFX=@DECD_SUFX,
ALIAS_FRST_NME=@ALIAS_FRST_NME,
ALIAS_MIDD_NME=@ALIAS_MIDD_NME,
ALIAS_LST_NME=@ALIAS_LST_NME,
ALIAS_SUFX=@ALIAS_SUFX,
DECD_SEX=@DECD_SEX,
DECD_AGE_TYPE=@DECD_AGE_TYPE,
DECD_AGE_YR=@DECD_AGE_YR,
DECD_AGE_MON=@DECD_AGE_MON,
DECD_AGE_DAY=@DECD_AGE_DAY,
DECD_AGE_HR=@DECD_AGE_HR,
DECD_AGE_MIN=@DECD_AGE_MIN,
DECD_BRTH_DT=STR_TO_DATE(@DECD_BRTH_DT, '%m/%d/%Y'),
DECD_DTH_DT=STR_TO_DATE(@DECD_DTH_DT, '%m/%d/%Y'),
DECD_BRTH_CNTRY=@DECD_BRTH_CNTRY,
DECD_BRTH_CNTRY_FIPS_CD=@DECD_BRTH_CNTRY_FIPS_CD,
DECD_BRTH_ST=@DECD_BRTH_ST,
DECD_BRTH_ST_FIPS_CD=@DECD_BRTH_ST_FIPS_CD,
DECD_BRTH_CTY=@DECD_BRTH_CTY,
DECD_BRTH_CTY_FIPS_CD=@DECD_BRTH_CTY_FIPS_CD,
DECD_RES_NURSING=@DECD_RES_NURSING,
DECD_RES_FCLTY=@DECD_RES_FCLTY,
DECD_RES_STRT=@DECD_RES_STRT,
DECD_RES_MLTIUNIT=@DECD_RES_MLTIUNIT,
DECD_RES_CTY=@DECD_RES_CTY,
DECD_RES_CTY_OTHER=@DECD_RES_CTY_OTHER,
DECD_RES_CTY_FIPS_CD=@DECD_RES_CTY_FIPS_CD,
DECD_RES_ST=@DECD_RES_ST,
DECD_RES_ST_FIPS_CD=@DECD_RES_ST_FIPS_CD,
DECD_RES_ZIP5=@DECD_RES_ZIP5,
DECD_RES_ZIP4=@DECD_RES_ZIP4,
DECD_RES_CNTRY=@DECD_RES_CNTRY,
DECD_RES_CNTRY_OTHER=@DECD_RES_CNTRY_OTHER,
DECD_RES_CNTRY_FIPS_CD=@DECD_RES_CNTRY_FIPS_CD,
DECD_RES_CNTY=@DECD_RES_CNTY,
DECD_RES_CNTY_FIPS_CD=@DECD_RES_CNTY_FIPS_CD,
DECD_RES_INTL_FL=@DECD_RES_INTL_FL,
DECD_RES_INTL_CD=@DECD_RES_INTL_CD,
DECD_RES_CTY_TWNSHP_LIMITS=@DECD_RES_CTY_TWNSHP_LIMITS,
DECD_ARMF_FL=@DECD_ARMF_FL,
DECD_MRTL_STATUS=@DECD_MRTL_STATUS,
DECD_MRTL_STATUS_CD=@DECD_MRTL_STATUS_CD,
SPS_FRST_NME=@SPS_FRST_NME,
SPS_MIDD_NME=@SPS_MIDD_NME,
SPS_LST_NME=@SPS_LST_NME,
FTHR_FRST_NME=@FTHR_FRST_NME,
FTHR_MIDD_NME=@FTHR_MIDD_NME,
FTHR_LST_NME=@FTHR_LST_NME,
FTHR_SFX_NME=@FTHR_SFX_NME,
MTHR_FRST_NME=@MTHR_FRST_NME,
MTHR_MIDD_NME=@MTHR_MIDD_NME,
MTHR_MAIDN_NME=@MTHR_MAIDN_NME,
MTHR_SFX_NME=@MTHR_SFX_NME,
IFRMT_TYPE=@IFRMT_TYPE,
IFRMT_FRST_NME=@IFRMT_FRST_NME,
IFRMT_MIDD_NME=@IFRMT_MIDD_NME,
IFRMT_LST_NME=@IFRMT_LST_NME,
IFRMT_SFX_NME=@IFRMT_SFX_NME,
IFRMT_ENTITY=@IFRMT_ENTITY,
IFRMT_RLSHP=@IFRMT_RLSHP,
IFRMT_ADDR_SAME_AS_DECD=@IFRMT_ADDR_SAME_AS_DECD,
IFRMT_ADDR_STRT=@IFRMT_ADDR_STRT,
IFRMT_ADDR_MLTIUNIT=@IFRMT_ADDR_MLTIUNIT,
IFRMT_ADDR_CTY=@IFRMT_ADDR_CTY,
IFRMT_ADDR_CTY_OTHER=@IFRMT_ADDR_CTY_OTHER,
IFRMT_ADDR_CTY_FIPS_CD=@IFRMT_ADDR_CTY_FIPS_CD,
IFRMT_ADDR_ST=@IFRMT_ADDR_ST,
IFRMT_ADDR_ST_FIPS_CD=@IFRMT_ADDR_ST_FIPS_CD,
IFRMT_ADDR_CNTRY=@IFRMT_ADDR_CNTRY,
IFRMT_ADDR_CNTRY_FIPS_CD=@IFRMT_ADDR_CNTRY_FIPS_CD,
IFRMT_ADDR_ZIP5=@IFRMT_ADDR_ZIP5,
IFRMT_ADDR_ZIP4=@IFRMT_ADDR_ZIP4,
IFRMT_ADDR_INTL_FL=@IFRMT_ADDR_INTL_FL,
IFRMT_ADDR_INTL_CD=@IFRMT_ADDR_INTL_CD,
DECD_PLCE_DTH_TYP=@DECD_PLCE_DTH_TYP,
DECD_PLCE_DTH_OTHR=@DECD_PLCE_DTH_OTHR,
DECD_PLCE_DTH_TYP_CD=@DECD_PLCE_DTH_TYP_CD,
DECD_DTH_FCLTY=@DECD_DTH_FCLTY,
DECD_DTH_FCLTY_ID=@DECD_DTH_FCLTY_ID,
DECD_DTH_FCLTY_OTHR=@DECD_DTH_FCLTY_OTHR,
DECD_DTH_STRT=@DECD_DTH_STRT,
DECD_DTH_MLTIUNIT=@DECD_DTH_MLTIUNIT,
DECD_DTH_CTY=@DECD_DTH_CTY,
DECD_DTH_CTY_OTHER=@DECD_DTH_CTY_OTHER,
DECD_DTH_CTY_FIPS_CD=@DECD_DTH_CTY_FIPS_CD,
DECD_DTH_ST=@DECD_DTH_ST,
DECD_DTH_ST_FIPS_ALPHA_CD=@DECD_DTH_ST_FIPS_ALPHA_CD,
DECD_DTH_CNTRY=@DECD_DTH_CNTRY,
DECD_DTH_CNTRY_OTHER=@DECD_DTH_CNTRY_OTHER,
DECD_DTH_CNTRY_FIPS_CD=@DECD_DTH_CNTRY_FIPS_CD,
DECD_DTH_ZIP5=@DECD_DTH_ZIP5,
DECD_DTH_ZIP4=@DECD_DTH_ZIP4,
DECD_DTH_INTL_FL=@DECD_DTH_INTL_FL,
DECD_DTH_INTL_CD=@DECD_DTH_INTL_CD,
DECD_DTH_CNTY=@DECD_DTH_CNTY,
DECD_DTH_CNTY_FIPS_CD=@DECD_DTH_CNTY_FIPS_CD,
DISP_MTHD_CREM=@DISP_MTHD_CREM,
DISP_MTHD_BURIAL=@DISP_MTHD_BURIAL,
DISP_MTHD_DON=@DISP_MTHD_DON,
DISP_MTHD_ENT=@DISP_MTHD_ENT,
DISP_MTHD_RMVL_FRM_ST=@DISP_MTHD_RMVL_FRM_ST,
DISP_MTHD_OTHR=@DISP_MTHD_OTHR,
DISP_MTHD_OTHR_TEXT=@DISP_MTHD_OTHR_TEXT,
DISP_MTHD_UNKN=@DISP_MTHD_UNKN,
DISP_CMTRY_PLCE=@DISP_CMTRY_PLCE,
DISP_CMTRY_PLCE_OTHR=@DISP_CMTRY_PLCE_OTHR,
DISP_CMTRY_CNTRY=@DISP_CMTRY_CNTRY,
DISP_CMTRY_ST=@DISP_CMTRY_ST,
DISP_CMTRY_CTY=@DISP_CMTRY_CTY,
CREM_NME=@CREM_NME,
CREM_NME_OTHR=@CREM_NME_OTHR,
CREM_CNTRY=@CREM_CNTRY,
CREM_ST=@CREM_ST,
CREM_CTY=@CREM_CTY,
AUTHR_LIC_NBR=@AUTHR_LIC_NBR,
AUTHR_FRST_NME=@AUTHR_FRST_NME,
AUTHR_MIDD_NME=@AUTHR_MIDD_NME,
AUTHR_LST_NME=@AUTHR_LST_NME,
AUTHR_TITLE=@AUTHR_TITLE,
INSTITUTION_TYPE=@INSTITUTION_TYPE,
FD_FH_ESTAB_NBR=@FD_FH_ESTAB_NBR,
FD_FH_NME=@FD_FH_NME,
FD_FH_LOC_STRT=@FD_FH_LOC_STRT,
FD_FH_LOC_MLTIUNIT=@FD_FH_LOC_MLTIUNIT,
FD_FH_LOC_CTY=@FD_FH_LOC_CTY,
FD_FH_LOC_ST=@FD_FH_LOC_ST,
FD_FH_LOC_ST_FIPS_CD=@FD_FH_LOC_ST_FIPS_CD,
FD_FH_LOC_ZIP5=@FD_FH_LOC_ZIP5,
FD_FH_LOC_ZIP4=@FD_FH_LOC_ZIP4,
FD_FH_LOC_INTL_FL=@FD_FH_LOC_INTL_FL,
FD_FH_LOC_INTL_CD=@FD_FH_LOC_INTL_CD,
FD_FH_LOC_CNTRY=@FD_FH_LOC_CNTRY,
FD_LIC_NBR=@FD_LIC_NBR,
FD_FRST_NME=@FD_FRST_NME,
FD_MIDD_NME=@FD_MIDD_NME,
FD_LST_NME=@FD_LST_NME,
FD_SFX_NME=@FD_SFX_NME,
DECD_DTH_DT_FOUND=STR_TO_DATE(@DECD_DTH_DT_FOUND, '%m/%d/%Y'),
DECD_DTH_DT_MODIFIER=@DECD_DTH_DT_MODIFIER,
DECD_DTH_TM=@DECD_DTH_TM,
DECD_DTH_TIME_INDICATOR=@DECD_DTH_TIME_INDICATOR,
DECD_DTH_TIME_FOUND=@DECD_DTH_TIME_FOUND,
DECD_DTH_TM_MODIFIER=@DECD_DTH_TM_MODIFIER,
ME_CONTACTED=@ME_CONTACTED,
CA_DISPOSITION_POSTPONE=@CA_DISPOSITION_POSTPONE,
CA_DISPOSITION_POSTPONE_REASON=@CA_DISPOSITION_POSTPONE_REASON,
CA_INJURY_OR_TRAUMA=@CA_INJURY_OR_TRAUMA,
CA_INJURY_OR_TRAUMA_DESCRIBE=@CA_INJURY_OR_TRAUMA_DESCRIBE,
DT_LAST_SEEN_DAY=@DT_LAST_SEEN_DAY,
DT_LAST_SEEN_MONTH=@DT_LAST_SEEN_MONTH,
DT_LAST_SEEN_YEAR=@DT_LAST_SEEN_YEAR,
CAUSE_DTH_A=@CAUSE_DTH_A,
CAUSE_INTRVL_A=@CAUSE_INTRVL_A,
CAUSE_DTH_B=@CAUSE_DTH_B,
CAUSE_INTRVL_B=@CAUSE_INTRVL_B,
CAUSE_DTH_C=@CAUSE_DTH_C,
CAUSE_INTRVL_C=@CAUSE_INTRVL_C,
CAUSE_DTH_D=@CAUSE_DTH_D,
CAUSE_INTRVL_D=@CAUSE_INTRVL_D,
CAUSE_DTH_OTHR=@CAUSE_DTH_OTHR,
ME_AUTPSY=@ME_AUTPSY,
ME_AUTPSY_RES_AVLBL=@ME_AUTPSY_RES_AVLBL,
TOBACCO_CONTRIBUTED=@TOBACCO_CONTRIBUTED,
DECD_PREG_DESC=@DECD_PREG_DESC,
DECD_PREG_CD=@DECD_PREG_CD,
CERTFR_MANNER_DTH=@CERTFR_MANNER_DTH,
CERTFR_MANNER_DTH_CD=@CERTFR_MANNER_DTH_CD,
INJURY_FL=@INJURY_FL,
INJURY_DT_TXT=@INJURY_DT,
INJURY_DT_CANNOT_DETERMINE=@INJURY_DT_CANNOT_DETERMINE,
INJURY_TM=@INJURY_TM,
INJURY_TM_CANNOT_DETERMINE=@INJURY_TM_CANNOT_DETERMINE,
INJURY_PLCE_TYP=@INJURY_PLCE_TYP,
INJURY_WORK=@INJURY_WORK,
INJURY_LOC_STRT=@INJURY_LOC_STRT,
INJURY_LOC_MLTIUNIT=@INJURY_LOC_MLTIUNIT,
INJURY_LOC_CTY=@INJURY_LOC_CTY,
INJURY_LOC_CTY_OTHER=@INJURY_LOC_CTY_OTHER,
INJURY_LOC_CTY_FIPS_CD=@INJURY_LOC_CTY_FIPS_CD,
INJURY_LOC_ST=@INJURY_LOC_ST,
INJURY_LOC_ST_FIPS_CD=@INJURY_LOC_ST_FIPS_CD,
INJURY_LOC_CNTRY=@INJURY_LOC_CNTRY,
INJURY_LOC_CNTRY_OTHER=@INJURY_LOC_CNTRY_OTHER,
INJURY_LOC_CNTRY_FIPS_CD=@INJURY_LOC_CNTRY_FIPS_CD,
INJURY_LOC_CNTY=@INJURY_LOC_CNTY,
INJURY_LOC_CNTY_FIPS_CD=@INJURY_LOC_CNTY_FIPS_CD,
INJURY_LOC_ZIP5=@INJURY_LOC_ZIP5,
INJURY_LOC_ZIP4=@INJURY_LOC_ZIP4,
INJURY_LOC_INTL_FL=@INJURY_LOC_INTL_FL,
INJURY_LOC_INTL_CD=@INJURY_LOC_INTL_CD,
INJURY_DESC=@INJURY_DESC,
INJURY_LOC_TRANSPORT=@INJURY_LOC_TRANSPORT,
INJURY_LOC_TRANSPORT_CD=@INJURY_LOC_TRANSPORT_CD,
CERTFR_FRST_NME=@CERTFR_FRST_NME,
CERTFR_MIDD_NME=@CERTFR_MIDD_NME,
CERTFR_LST_NME=@CERTFR_LST_NME,
CERTFR_SFX_NME=@CERTFR_SFX_NME,
CERTFR_ADDR_STRT=@CERTFR_ADDR_STRT,
CERTFR_ADDR_MLTIUNIT=@CERTFR_ADDR_MLTIUNIT,
CERTFR_ADDR_CTY=@CERTFR_ADDR_CTY,
CERTFR_ADDR_CTY_OTHER=@CERTFR_ADDR_CTY_OTHER,
CERTFR_ADDR_CTY_FIPS_CD=@CERTFR_ADDR_CTY_FIPS_CD,
CERTFR_ADDR_ST=@CERTFR_ADDR_ST,
CERTFR_ADDR_ST_FIPS_CD=@CERTFR_ADDR_ST_FIPS_CD,
CERTFR_ADDR_CNTRY=@CERTFR_ADDR_CNTRY,
CERTFR_ADDR_CNTRY_OTHER=@CERTFR_ADDR_CNTRY_OTHER,
CERTFR_ADDR_CNTRY_FIPS_CD=@CERTFR_ADDR_CNTRY_FIPS_CD,
CERTFR_ADDR_ZIP5=@CERTFR_ADDR_ZIP5,
CERTFR_ADDR_ZIP4=@CERTFR_ADDR_ZIP4,
CERTFR_ADDR_INTL_FL=@CERTFR_ADDR_INTL_FL,
CERTFR_ADDR_INTL_CD=@CERTFR_ADDR_INTL_CD,
CERTFR_TITLE=@CERTFR_TITLE,
CERTFR_LIC_NBR=@CERTFR_LIC_NBR,
CERTFR_NPI_CD=@CERTFR_NPI_CD,
DT_FILED_MED=STR_TO_DATE(@DT_FILED_MED, '%m/%d/%Y'),
DT_FILED_LEGL=STR_TO_DATE(@DT_FILED_LEGL, '%m/%d/%Y'),
CMPLT_FL=@CMPLT_FL,
DECD_EDUC=@DECD_EDUC,
DECD_EDUC_CD=@DECD_EDUC_CD,
DECD_OCPTN=@DECD_OCPTN,
DECD_IDSTY=@DECD_IDSTY,
SUBJECT_NOT_HISPANIC=@SUBJECT_NOT_HISPANIC,
SUBJECT_MEXICAN=@SUBJECT_MEXICAN,
SUBJECT_PUERTO_RICAN=@SUBJECT_PUERTO_RICAN,
SUBJECT_CUBAN=@SUBJECT_CUBAN,
SUBJECT_OTHER_SPANISH=@SUBJECT_OTHER_SPANISH,
SUBJECT_OTHR_SPAN_TXT=@SUBJECT_OTHR_SPAN_TXT,
SUBJECT_REFUSED_HISPANIC=@SUBJECT_REFUSED_HISPANIC,
SUBJECT_UNKNOWN_HISPANIC=@SUBJECT_UNKNOWN_HISPANIC,
SUBJECT_NOTOBTAINABLE_HISPANIC=@SUBJECT_NOTOBTAINABLE_HISPANIC,
SUBJECT_WHITE=@SUBJECT_WHITE,
SUBJECT_AFRICAN_AMERICAN=@SUBJECT_AFRICAN_AMERICAN,
SUBJECT_SOMALI=@SUBJECT_SOMALI,
SUBJECT_ETHIOPIAN=@SUBJECT_ETHIOPIAN,
SUBJECT_LIBERIAN=@SUBJECT_LIBERIAN,
SUBJECT_KENYAN=@SUBJECT_KENYAN,
SUBJECT_SUDANESE=@SUBJECT_SUDANESE,
SUBJECT_NIGERIAN=@SUBJECT_NIGERIAN,
SUBJECT_GHANIAN=@SUBJECT_GHANIAN,
SUBJECT_OTHER_AFRICAN=@SUBJECT_OTHER_AFRICAN,
SUBJECT_OTHER_AFRICAN_TXT=@SUBJECT_OTHER_AFRICAN_TXT,
SUBJECT_AMERICAN_INDIAN=@SUBJECT_AMERICAN_INDIAN,
SUBJECT_TRIBE_TXT1=@SUBJECT_TRIBE_TXT1,
SUBJECT_TRIBE_TXT2=@SUBJECT_TRIBE_TXT2,
SUBJECT_ASIAN_INDIAN=@SUBJECT_ASIAN_INDIAN,
SUBJECT_CHINESE=@SUBJECT_CHINESE,
SUBJECT_FILIPINO=@SUBJECT_FILIPINO,
SUBJECT_JAPANESE=@SUBJECT_JAPANESE,
SUBJECT_KOREAN=@SUBJECT_KOREAN,
SUBJECT_VIETNAMESE=@SUBJECT_VIETNAMESE,
SUBJECT_HMONG=@SUBJECT_HMONG,
SUBJECT_CAMBODIAN=@SUBJECT_CAMBODIAN,
SUBJECT_LAOTIAN=@SUBJECT_LAOTIAN,
SUBJECT_OTHER_ASIAN=@SUBJECT_OTHER_ASIAN,
SUBJECT_OTHR_ASN_TXT1=@SUBJECT_OTHR_ASN_TXT1,
SUBJECT_OTHR_ASN_TXT2=@SUBJECT_OTHR_ASN_TXT2,
SUBJECT_HAWAIIAN=@SUBJECT_HAWAIIAN,
SUBJECT_GUAMANIAN_CHAMORRO=@SUBJECT_GUAMANIAN_CHAMORRO,
SUBJECT_SAMOAN=@SUBJECT_SAMOAN,
SUBJECT_OTHER_PACIFIC_ISLANDER=@SUBJECT_OTHER_PACIFIC_ISLANDER,
SUBJECT_OTHR_PAC_ISLE_TXT1=@SUBJECT_OTHR_PAC_ISLE_TXT1,
SUBJECT_OTHR_PAC_ISLE_TXT2=@SUBJECT_OTHR_PAC_ISLE_TXT2,
SUBJECT_OTHER=@SUBJECT_OTHER,
SUBJECT_OTHR_TXT1=@SUBJECT_OTHR_TXT1,
SUBJECT_OTHR_TXT2=@SUBJECT_OTHR_TXT2,
SUBJECT_REFUSED_RACE=@SUBJECT_REFUSED_RACE,
SUBJECT_UNKNOWN=@SUBJECT_UNKNOWN,
SUBJECT_NOTOBTAINABLE_RACE=@SUBJECT_NOTOBTAINABLE_RACE,
SUBJECT_RACE_MVR=@SUBJECT_RACE_MVR,
SUBJECT_RACE1E=@SUBJECT_RACE1E,
SUBJECT_RACE2E=@SUBJECT_RACE2E,
SUBJECT_RACE3E=@SUBJECT_RACE3E,
SUBJECT_RACE4E=@SUBJECT_RACE4E,
SUBJECT_RACE5E=@SUBJECT_RACE5E,
SUBJECT_RACE6E=@SUBJECT_RACE6E,
SUBJECT_RACE7E=@SUBJECT_RACE7E,
SUBJECT_RACE8E=@SUBJECT_RACE8E,
SUBJECT_RACE16C=@SUBJECT_RACE16C,
SUBJECT_RACE17C=@SUBJECT_RACE17C,
SUBJECT_RACE18C=@SUBJECT_RACE18C,
SUBJECT_RACE19C=@SUBJECT_RACE19C,
SUBJECT_RACE20C=@SUBJECT_RACE20C,
SUBJECT_RACE21C=@SUBJECT_RACE21C,
SUBJECT_RACE22C=@SUBJECT_RACE22C,
SUBJECT_RACE23C=@SUBJECT_RACE23C,
SUBJECT_ETHNICE=@SUBJECT_ETHNICE,
SUBJECT_ETHNIC5C=@SUBJECT_ETHNIC5C,
SUBJECT_RACEBRG=@SUBJECT_RACEBRG,
RAC_ICD01=@RAC_ICD01,
RAC_CREATED01=@RAC_CREATED01,
RAC_ICD02=@RAC_ICD02,
RAC_CREATED02=@RAC_CREATED02,
RAC_ICD03=@RAC_ICD03,
RAC_CREATED03=@RAC_CREATED03,
RAC_ICD04=@RAC_ICD04,
RAC_CREATED04=@RAC_CREATED04,
RAC_ICD05=@RAC_ICD05,
RAC_CREATED05=@RAC_CREATED05,
RAC_ICD06=@RAC_ICD06,
RAC_CREATED06=@RAC_CREATED06,
RAC_ICD07=@RAC_ICD07,
RAC_CREATED07=@RAC_CREATED07,
RAC_ICD08=@RAC_ICD08,
RAC_CREATED08=@RAC_CREATED08,
RAC_ICD09=@RAC_ICD09,
RAC_CREATED09=@RAC_CREATED09,
RAC_ICD10=@RAC_ICD10,
RAC_CREATED10=@RAC_CREATED10,
RAC_ICD11=@RAC_ICD11,
RAC_CREATED11=@RAC_CREATED11,
RAC_ICD12=@RAC_ICD12,
RAC_CREATED12=@RAC_CREATED12,
RAC_ICD13=@RAC_ICD13,
RAC_CREATED13=@RAC_CREATED13,
RAC_ICD14=@RAC_ICD14,
RAC_CREATED14=@RAC_CREATED14,
RAC_ICD15=@RAC_ICD15,
RAC_CREATED15=@RAC_CREATED15,
RAC_ICD16=@RAC_ICD16,
RAC_CREATED16=@RAC_CREATED16,
RAC_ICD17=@RAC_ICD17,
RAC_CREATED17=@RAC_CREATED17,
RAC_ICD18=@RAC_ICD18,
RAC_CREATED18=@RAC_CREATED18,
RAC_ICD19=@RAC_ICD19,
RAC_CREATED19=@RAC_CREATED19,
RAC_ICD20=@RAC_ICD20,
RAC_CREATED20=@RAC_CREATED20,
ACME_UNLY_CAUSE_DTH=@ACME_UNLY_CAUSE_DTH,
MNL_UNLY_CAUSE_DTH=@MNL_UNLY_CAUSE_DTH,
STRIBIMPORTDATE=NOW(),
SOURCECODE='MDHFull';

####SECTION 2 #############################################################

#this updates the indexes
OPTIMIZE TABLE Deaths_original;

UPDATE Deaths_original set YR= year(decd_dth_dt);

update Deaths_original set decd_frst_nme=ltrim(decd_frst_nme) ;
update Deaths_original set decd_midd_nme=ltrim(decd_midd_nme) ;
update Deaths_original set decd_lst_nme=ltrim(decd_lst_nme) ;

update Deaths_original 
inner join deaths_race_lkup on Deaths_original.SUBJECT_RACEBRG=deaths_race_lkup.racebridge
set Deaths_original.race = deaths_race_lkup.racedesc;


update Deaths_original set race='White' where race is null and SUBJECT_WHITE='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_AFRICAN_AMERICAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_SOMALI='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_ETHIOPIAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_LIBERIAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_KENYAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_SUDANESE='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_NIGERIAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_GHANIAN='Y';
update Deaths_original set race='African American' where race is null and SUBJECT_OTHER_AFRICAN='Y';
update Deaths_original set race='American Indian' where race is null and SUBJECT_AMERICAN_INDIAN='Y';
update Deaths_original set race='Asian Indian' where race is null and SUBJECT_ASIAN_INDIAN='Y';
update Deaths_original set race='Chinese' where race is null and SUBJECT_CHINESE='Y';
update Deaths_original set race='Filipino' where race is null and SUBJECT_FILIPINO='Y';
update Deaths_original set race='Japanese' where race is null and SUBJECT_JAPANESE='Y';
update Deaths_original set race='Korean' where race is null and SUBJECT_KOREAN='Y';
update Deaths_original set race='Vietnamese' where race is null and SUBJECT_VIETNAMESE='Y';
update Deaths_original set race='Other Asian' where race is null and SUBJECT_HMONG='Y';
update Deaths_original set race='Other Asian' where race is null and SUBJECT_CAMBODIAN='Y';
update Deaths_original set race='Other Asian' where race is null and SUBJECT_LAOTIAN='Y';
update Deaths_original set race='Other Asian' where race is null and SUBJECT_OTHER_ASIAN='Y';
update Deaths_original set race='Hawaiian' where race is null and SUBJECT_HAWAIIAN='Y';
update Deaths_original set race='Guanmanian/Chamorro' where race is null and SUBJECT_GUAMANIAN_CHAMORRO='Y';
update Deaths_original set race='Samoan' where race is null and SUBJECT_SAMOAN='Y';
update Deaths_original set race='Other Pacific Islander' where race is null and SUBJECT_OTHER_PACIFIC_ISLANDER='Y';
update Deaths_original set race='Other Race' where race is null and SUBJECT_OTHER='Y';
update Deaths_original set race='Unknown' where race is null and SUBJECT_REFUSED_RACE='Y';
update Deaths_original set race='Unknown' where race is null and SUBJECT_UNKNOWN='Y';
update Deaths_original set race='Unknown' where race is null and SUBJECT_NOTOBTAINABLE_RACE='Y';

update Deaths_original set HispanicEthnicity='NOT HISPANIC' where subject_not_hispanic='Y';
update Deaths_original set HispanicEthnicity='HISPANIC' where subject_mexican='Y' OR SUBJECT_PUERTO_RICAN='Y' OR SUBJECT_CUBAN='Y'
OR SUBJECT_OTHER_SPANISH='Y';
UPDATE Deaths_original SET HISPANICETHNICITY='UNKNOWN' WHERE SUBJECT_REFUSED_HISPANIC='Y' OR SUBJECT_UNKNOWN_HISPANIC='Y' OR SUBJECT_NOTOBTAINABLE_HISPANIC='Y';
UPDATE Deaths_original SET HISPANICETHNICITY='UNKNOWN' where hispanicethnicity is null;





update Deaths_original set inj_month='01' where injury_dt_txt like '%JAN%';
update Deaths_original set inj_month='02' where injury_dt_txt like '%FEB%';
update Deaths_original set inj_month='03' where injury_dt_txt like '%MAR%';
update Deaths_original set inj_month='04' where injury_dt_txt like '%APR%';
update Deaths_original set inj_month='05' where injury_dt_txt like '%MAY%';
update Deaths_original set inj_month='06' where injury_dt_txt like '%JUN%';
update Deaths_original set inj_month='07' where injury_dt_txt like '%JUL%';
update Deaths_original set inj_month='08' where injury_dt_txt like '%AUG%';
update Deaths_original set inj_month='09' where injury_dt_txt like '%SEP%';
update Deaths_original set inj_month='10' where injury_dt_txt like '%OCT%';
update Deaths_original set inj_month='11' where injury_dt_txt like '%NOV%';
update Deaths_original set inj_month='12' where injury_dt_txt like '%DEC%';


update Deaths_original set Injury_date=concat('19',right(injury_dt_txt,2),'-',INJ_MONTH,'-',LEFT(INJURY_DT_TXT,2))
where right(injury_dt_txt,2) not like '0%' and right(injury_dt_txt,2) not like '1%' and injury_dt_txt not like '';


update Deaths_original set Injury_date=concat('20',right(injury_dt_txt,2),'-',INJ_MONTH,'-',LEFT(INJURY_DT_TXT,2))
where injury_date is null and injury_dt_txt<>'';




update Deaths_original set certfr_manner_dth='ACCIDENT' where certfr_manner_dth='A';
update Deaths_original set certfr_manner_dth='NATURAL' where certfr_manner_dth='N';
update Deaths_original set certfr_manner_dth='SUICIDE' where certfr_manner_dth='S';
update Deaths_original set certfr_manner_dth='HOMICIDE' where certfr_manner_dth='H';



####SECTION 3 #############################################################


insert into deaths_main(STATEID,FIRSTNAME,MIDDLENAME,LASTNAME,MAIDENNAME,SUFFIX,BIRTHDATE,DEATHDATE,GENDER,RACE,HISPANICETHNICITY,AGE_TYPE,AGEYEARS,AGEMONTHS,AGEDAYS,AGEHOURS,AGEMINUTES,BIRTHCOUNTRY,BIRTHSTATE,BIRTHCITY,NURSHOME,RESFACILITY,RESADDRESS,RESCOUNTRY,RESSTATE,RESCOUNTY,RESCITY,ZIP,ARMEDFORCES,YEARSEDUCATION,OCCUPATION,INDUSTRY,MARITALSTATUS,SPOUSEFIRST,SPOUSEMIDDLE,SPOUSELAST,FATHERFIRST,FATHERMIDDLE,FATHERLAST,FATHERSUFFIX,MOTHERFIRST,MOTHERMIDDLE,MOTHERMAIDEN,PLACETYPE,PLACEOTHER,FACILITY,FACILITYOTHER,DEATHADDRESS,DEATHCOUNTRY,DEATHSTATE,DEATHCITY,DEATHZIP,DEATHCOUNTY,CAUSEA,CAUSEB,CAUSEC,CAUSED,CAUSEOTHER,MANNERDEATH,
INJURY_DATE,INJURYPLACE,INJURYWORK,INJURYADDRESS,INJURYSTATE,INJURYCOUNTY,INJURYCOUNTRY,INJURYCITY,INJURYZIP,INJURYDESC,IMPORTDATE,DEATHYEAR,SOURCECODE)
SELECT TRIM(ST_FILE_NBR) AS STATEID, 
TRIM(DECD_FRST_NME) AS FIRSTNAME, 
TRIM(DECD_MIDD_NME) AS MIDDLENAME, 
TRIM(DECD_LST_NME) AS LASTNAME, 
TRIM(DECD_MAIDN_NME) AS MAIDENNAME, 
TRIM(DECD_SUFX) AS SUFFIX, 
DECD_BRTH_DT AS BIRTHDATE, 
DECD_DTH_DT AS DEATHDATE, 
TRIM(DECD_SEX) AS GENDER, 
TRIM(RACE) AS RACE, 
TRIM(HISPANICETHNICITY) AS HISPANICETHNICITY, 
TRIM(DECD_AGE_TYPE) AS AGE_TYPE, 
DECD_AGE_YR AS AGEYEARS, 
DECD_AGE_MON AS AGEMONTHS, 
DECD_AGE_DAY AS AGEDAYS, 
DECD_AGE_HR AS AGEHOURS, 
DECD_AGE_MIN AS AGEMINUTES, 
TRIM(DECD_BRTH_CNTRY) AS BIRTHCOUNTRY, 
TRIM(DECD_BRTH_ST) AS BIRTHSTATE, 
TRIM(DECD_BRTH_CTY) AS BIRTHCITY, 
TRIM(DECD_RES_NURSING) AS NURSHOME, 
TRIM(DECD_RES_FCLTY) AS RESFACILITY , 
TRIM(DECD_RES_STRT) AS RESADDRESS, 
TRIM(DECD_RES_CNTRY) AS RESCOUNTRY, 
TRIM(DECD_RES_ST) AS RESSTATE, 
TRIM(DECD_RES_CNTY) AS RESCOUNTY, 
TRIM(DECD_RES_CTY) AS RESCITY, 
TRIM(DECD_RES_ZIP5) AS ZIP, 
TRIM(DECD_ARMF_FL) AS ARMEDFORCES, 
TRIM(DECD_EDUC) AS YEARSEDUCATION, 
TRIM(DECD_OCPTN) AS OCCUPATION, 
TRIM(DECD_IDSTY) AS INDUSTRY, 
TRIM(DECD_MRTL_STATUS) AS MARITALSTATUS, 
TRIM(SPS_FRST_NME) AS SPOUSEFIRST, 
TRIM(SPS_MIDD_NME) AS SPOUSEMIDDLE, 
TRIM(SPS_LST_NME) AS SPOUSELAST, 
TRIM(FTHR_FRST_NME) AS FATHERFIRST, 
TRIM(FTHR_MIDD_NME) AS FATHERMIDDLE, 
TRIM(FTHR_LST_NME) AS FATHERLAST, 
TRIM(FTHR_SFX_NME) AS FATHERSUFFIX, 
TRIM(MTHR_FRST_NME) AS MOTHERFIRST, 
TRIM(MTHR_MIDD_NME) AS MOTHERMIDDLE, 
TRIM(MTHR_MAIDN_NME) AS MOTHERMAIDEN, 
TRIM(DECD_PLCE_DTH_TYP) AS PLACETYPE, 
TRIM(DECD_PLCE_DTH_OTHR) AS PLACEOTHER, 
TRIM(DECD_DTH_FCLTY) AS FACILITY, 
TRIM(DECD_DTH_FCLTY_OTHR) AS FACILITYOTHER, 
TRIM(DECD_DTH_STRT) AS DEATHADDRESS, 
TRIM(DECD_DTH_CNTRY) AS DEATHCOUNTRY, 
TRIM(DECD_DTH_ST) AS DEATHSTATE, 
TRIM(DECD_DTH_CTY) AS DEATHCITY, 
TRIM(DECD_DTH_ZIP5) AS DEATHZIP, 
TRIM(DECD_DTH_CNTY) AS DEATHCOUNTY, 
TRIM(CAUSE_DTH_A) AS CAUSEA, 
TRIM(CAUSE_DTH_B) AS CAUSEB, 
TRIM(CAUSE_DTH_C) AS CAUSEC, 
TRIM(CAUSE_DTH_D) AS CAUSED, 
TRIM(CAUSE_DTH_OTHR) AS CAUSEOTHER, 
TRIM(CERTFR_MANNER_DTH) AS MANNERDEATH, 
INJURY_DATE, 
TRIM(INJURY_PLCE_TYP) AS INJURYPLACE, 
TRIM(INJURY_WORK) AS INJURYWORK, 
TRIM(INJURY_LOC_STRT) AS INJURYADDRESS, 
TRIM(INJURY_LOC_ST) AS INJURYSTATE, 
TRIM(INJURY_LOC_CNTY) AS INJURYCOUNTY, 
TRIM(INJURY_LOC_CNTRY) AS INJURYCOUNTRY , 
TRIM(INJURY_LOC_CTY) AS INJURYCITY, 
TRIM(INJURY_LOC_ZIP5) AS INJURYZIP, 
TRIM(INJURY_DESC) AS INJURYDESC, 
STRIBIMPORTDATE AS IMPORTDATE, 
TRIM(YR) AS DEATHYEAR, 
TRIM(SOURCECODE) AS SOURCECODE
FROM Deaths_original
;

OPTIMIZE TABLE deaths_main;

insert into deaths_other(STATEID,ALIAS_FRST_NME,ALIAS_MIDD_NME,ALIAS_LST_NME,ALIAS_SUFX,DECD_RES_CTY_TWNSHP_LIMITS,IFRMT_FRST_NME,IFRMT_MIDD_NME,IFRMT_LST_NME,IFRMT_RLSHP,IFRMT_ADDR_STRT,IFRMT_ADDR_CNTRY,IFRMT_ADDR_ST,IFRMT_ADDR_CTY,IFRMT_ADDR_ZIP5,DISP_MTHD_BURIAL,DISP_MTHD_ENT,DISP_MTHD_DON,DISP_MTHD_CREM,DISP_MTHD_RMVL_FRM_ST,DISP_MTHD_OTHR,DISP_MTHD_OTHR_TEXT,DISP_CMTRY_PLCE,DISP_CMTRY_ST,DISP_CMTRY_CTY,CREM_NME,AUTHR_FRST_NME,AUTHR_MIDD_NME,AUTHR_LST_NME,AUTHR_TITLE,FD_FH_ESTAB_NBR,FD_FH_NME,FD_LIC_NBR,FD_FRST_NME,FD_MIDD_NME,FD_LST_NME,ME_CONTACTED,CA_DISPOSITION_POSTPONE,CAUSE_INTRVL_A,CAUSE_INTRVL_B,CAUSE_INTRVL_C,CAUSE_INTRVL_D,ME_AUTPSY,ME_AUTPSY_RES_AVLBL,DECD_PREG_DESC,INJURY_TM,CERTFR_FRST_NME,CERTFR_MIDD_NME,CERTFR_LST_NME,CERTFR_ADDR_STRT,CERTFR_ADDR_ST,CERTFR_ADDR_CTY,CERTFR_ADDR_ZIP5,CERTFR_TITLE,CERTFR_LIC_NBR)
select ST_FILE_NBR,ALIAS_FRST_NME,ALIAS_MIDD_NME,ALIAS_LST_NME,ALIAS_SUFX,DECD_RES_CTY_TWNSHP_LIMITS,IFRMT_FRST_NME,IFRMT_MIDD_NME,IFRMT_LST_NME,IFRMT_RLSHP,IFRMT_ADDR_STRT,IFRMT_ADDR_CNTRY,IFRMT_ADDR_ST,IFRMT_ADDR_CTY,IFRMT_ADDR_ZIP5,DISP_MTHD_BURIAL,DISP_MTHD_ENT,DISP_MTHD_DON,DISP_MTHD_CREM,DISP_MTHD_RMVL_FRM_ST,DISP_MTHD_OTHR,DISP_MTHD_OTHR_TEXT,DISP_CMTRY_PLCE,DISP_CMTRY_ST,DISP_CMTRY_CTY,CREM_NME,AUTHR_FRST_NME,AUTHR_MIDD_NME,AUTHR_LST_NME,AUTHR_TITLE,FD_FH_ESTAB_NBR,FD_FH_NME,FD_LIC_NBR,FD_FRST_NME,FD_MIDD_NME,FD_LST_NME,ME_CONTACTED,CA_DISPOSITION_POSTPONE,CAUSE_INTRVL_A,CAUSE_INTRVL_B,CAUSE_INTRVL_C,CAUSE_INTRVL_D,ME_AUTPSY,ME_AUTPSY_RES_AVLBL,DECD_PREG_DESC,INJURY_TM,CERTFR_FRST_NME,CERTFR_MIDD_NME,CERTFR_LST_NME,CERTFR_ADDR_STRT,CERTFR_ADDR_ST,CERTFR_ADDR_CTY,CERTFR_ADDR_ZIP5,CERTFR_TITLE,CERTFR_LIC_NBR
from Deaths_original
;
OPTIMIZE table deaths_other;

insert into deaths_race(st_file_nbr,SUBJECT_NOT_HISPANIC,SUBJECT_MEXICAN,SUBJECT_PUERTO_RICAN,SUBJECT_CUBAN,SUBJECT_OTHER_SPANISH,SUBJECT_OTHER_SPANISH_TEXT,SUBJECT_REFUSED_HISPANIC,SUBJECT_HISPANIC_UNKNOWN,SUBJECT_NOTOBTAINABLE_HISPANIC,SUBJECT_WHITE,SUBJECT_AFRICAN_AMERICAN,SUBJECT_SOMALI,SUBJECT_ETHIOPIAN,SUBJECT_LIBERIAN,SUBJECT_KENYAN,SUBJECT_SUDANESE,SUBJECT_NIGERIAN,SUBJECT_GHANIAN,SUBJECT_OTHER_AFRICAN,SUBJECT_OTHER_AFRICAN_TEXT,SUBJECT_AMERICAN_INDIAN,SUBJECT_TRIBE_TEXT1,SUBJECT_TRIBE_TEXT2,SUBJECT_ASIAN_INDIAN,SUBJECT_CHINESE,SUBJECT_FILIPINO,SUBJECT_JAPANESE,SUBJECT_KOREAN,SUBJECT_VIETNAMESE,SUBJECT_HMONG,SUBJECT_CAMBODIAN,SUBJECT_LAOTIAN,SUBJECT_OTHER_ASIAN,SUBJECT_OTHER_ASIAN_TEXT1,SUBJECT_OTHER_ASIAN_TEXT2,SUBJECT_HAWAIIAN,SUBJECT_GUAMANIAN_CHAMORRO,SUBJECT_SAMOAN,SUBJECT_OTHER_PACIFIC_ISLANDER,OTHER_PACISLANDER_TEXT1,OTHER_PACISLANDER_TEXT2,SUBJECT_OTHER,SUBJECT_OTHER_TEXT1,SUBJECT_OTHER_TEXT2,SUBJECT_REFUSED_RACE,SUBJECT_UNKNOWN,SUBJECT_RACE_NOTOBTAINABLE,SUBJECT_RACE_MVR,SUBJECT_RACE1E,SUBJECT_RACE2E,SUBJECT_RACE3E,SUBJECT_RACE4E,SUBJECT_RACE5E,SUBJECT_RACE6E,SUBJECT_RACE7E,SUBJECT_RACE8E,SUBJECT_RACE16C,SUBJECT_RACE17C,SUBJECT_RACE18C,SUBJECT_RACE19C,SUBJECT_RACE20C,SUBJECT_RACE21C,SUBJECT_RACE22C,SUBJECT_RACE23C,SUBJECT_ETHNICE,SUBJECT_ETHNIC5C,SUBJECT_RACEBRG,deathyear)
select st_file_nbr,SUBJECT_NOT_HISPANIC,SUBJECT_MEXICAN,SUBJECT_PUERTO_RICAN,SUBJECT_CUBAN,
SUBJECT_OTHER_SPANISH,SUBJECT_OTHR_SPAN_TXT,
SUBJECT_REFUSED_HISPANIC,SUBJECT_UNKNOWN_HISPANIC,
SUBJECT_NOTOBTAINABLE_HISPANIC,SUBJECT_WHITE,SUBJECT_AFRICAN_AMERICAN,
SUBJECT_SOMALI,SUBJECT_ETHIOPIAN,SUBJECT_LIBERIAN,SUBJECT_KENYAN,SUBJECT_SUDANESE,
SUBJECT_NIGERIAN,SUBJECT_GHANIAN,SUBJECT_OTHER_AFRICAN,SUBJECT_OTHER_AFRICAN_TXT,
SUBJECT_AMERICAN_INDIAN,SUBJECT_TRIBE_TXT1,SUBJECT_TRIBE_TXT2,SUBJECT_ASIAN_INDIAN,
SUBJECT_CHINESE,SUBJECT_FILIPINO,SUBJECT_JAPANESE,SUBJECT_KOREAN,SUBJECT_VIETNAMESE,SUBJECT_HMONG,
SUBJECT_CAMBODIAN,SUBJECT_LAOTIAN,SUBJECT_OTHER_ASIAN,SUBJECT_OTHR_ASN_TXT1,SUBJECT_OTHR_ASN_TXT2,
SUBJECT_HAWAIIAN,SUBJECT_GUAMANIAN_CHAMORRO,SUBJECT_SAMOAN,SUBJECT_OTHER_PACIFIC_ISLANDER,SUBJECT_OTHR_PAC_ISLE_TXT1,
SUBJECT_OTHR_PAC_ISLE_TXT2,SUBJECT_OTHER,SUBJECT_OTHR_TXT1,SUBJECT_OTHR_TXT2,SUBJECT_REFUSED_RACE,
SUBJECT_UNKNOWN,SUBJECT_NOTOBTAINABLE_RACE,SUBJECT_RACE_MVR,SUBJECT_RACE1E,SUBJECT_RACE2E,SUBJECT_RACE3E,SUBJECT_RACE4E,SUBJECT_RACE5E,SUBJECT_RACE6E,SUBJECT_RACE7E,SUBJECT_RACE8E,SUBJECT_RACE16C,SUBJECT_RACE17C,SUBJECT_RACE18C,SUBJECT_RACE19C,SUBJECT_RACE20C,SUBJECT_RACE21C,SUBJECT_RACE22C,SUBJECT_RACE23C,SUBJECT_ETHNICE,SUBJECT_ETHNIC5C,SUBJECT_RACEBRG,YR
From Deaths_original
;

OPTIMIZE table deaths_race;


insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD01 as icd_code, '10' as icd_version, '1' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD01 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD02 as icd_code, '10' as icd_version, '2' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD02 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD03 as icd_code, '10' as icd_version, '3' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD03 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD04 as icd_code, '10' as icd_version, '4' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD04 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD05 as icd_code, '10' as icd_version, '5' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD05 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD06 as icd_code, '10' as icd_version, '6' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD06 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD07 as icd_code, '10' as icd_version, '7' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD07 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD08 as icd_code, '10' as icd_version, '8' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD08 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD09 as icd_code, '10' as icd_version, '9' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD09 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD10 as icd_code, '10' as icd_version, '10' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD10 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD11 as icd_code, '10' as icd_version, '11' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD11 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD12 as icd_code, '10' as icd_version, '12' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD12 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD13 as icd_code, '10' as icd_version, '13' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD13 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD14 as icd_code, '10' as icd_version, '14' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD14 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD15 as icd_code, '10' as icd_version, '15' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD15 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD16 as icd_code, '10' as icd_version, '16' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD16 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD17 as icd_code, '10' as icd_version, '17' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD17 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD18 as icd_code, '10' as icd_version, '18' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD18 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD19 as icd_code, '10' as icd_version, '19' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD19 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,RAC_ICD20 as icd_code, '10' as icd_version, '20' as icdposition, YR as deathyear
from Deaths_original
where RAC_ICD20 <>'';

insert into deaths_icd(st_file_nbr, icd_code, icd_version, icd_position, deathyear)
SELECT ST_FILE_NBR,acme_unly_cause_dth as icd_code, '10' as icd_version, 'Unly' as icdposition, YR as deathyear
from Deaths_original
where acme_unly_cause_dth <>'';


update deaths_icd 
inner join deaths_lkup_ICD10 ON deaths_icd.icd_code=deaths_lkup_ICD10.icd_code
set icd_desc=ICDCode_desc 
where icd_desc is null;


OPTIMIZE table deaths_icd;



update deaths_main set agegroup='00-04' where AGEYEARS<=4;
update deaths_main set agegroup='05-09' where AGEYEARS>=5 and ageyears<=9;
update deaths_main set agegroup='10-14' where AGEYEARS>=10 and ageyears<=14;
update deaths_main set agegroup='15-19' where AGEYEARS>=15 and ageyears<=19;
update deaths_main set agegroup='20-24' where AGEYEARS>=20 and ageyears<=24;
update deaths_main set agegroup='25-29' where AGEYEARS>=25 and ageyears<=29;
update deaths_main set agegroup='30-34' where AGEYEARS>=30 and ageyears<=34;
update deaths_main set agegroup='35-39' where AGEYEARS>=35 and ageyears<=39;

update deaths_main set agegroup='40-44' where AGEYEARS>=40 and ageyears<=44;
update deaths_main set agegroup='45-49' where AGEYEARS>=45 and ageyears<=49;

update deaths_main set agegroup='50-54' where AGEYEARS>=50 and ageyears<=54;
update deaths_main set agegroup='55-59' where AGEYEARS>=55 and ageyears<=59;

update deaths_main set agegroup='60-64' where AGEYEARS>=60 and ageyears<=64;
update deaths_main set agegroup='65-69' where AGEYEARS>=65 and ageyears<=69;

update deaths_main set agegroup='70-74' where AGEYEARS>=70 and ageyears<=74;
update deaths_main set agegroup='75-79' where AGEYEARS>=75 and ageyears<=79;

update deaths_main set agegroup='80-84' where AGEYEARS>=80 and ageyears<=84;
update deaths_main set agegroup='85+' where AGEYEARS>=85;




update deaths_icd 
inner join deaths_lkup_ICD10 on deaths_icd.icd_code=deaths_lkup_ICD10.icd_code
set deaths_icd.icd_desc = deaths_lkup_ICD10.ICDCode_Desc
where icd_desc is NULL;





####SECTION 4 #############################################################

#these are for the split out TABLES
update inventory set lastupdate=NOW() where idnumber=5 or idnumber=6 or idnumber=7 or idnumber=8;



#this was a problematic record in the 2016 data because there were no date values:
select *
from deaths_main where year(deathdate)='0000' or year(birthdate)='000'


#update deaths_main set birthdate='1776-01-01' where year(birthdate)='0000'
#update deaths_main set deathdate='1776-01-01', deathyear=left(stateid,4) where year(deathdate)='0000'


update deaths_main set deathdate='2016-11-21', birthdate='1776-01-01' where stateid='2016-MN-043426';
update deaths_main set deathdate='2016-11-21', birthdate='1776-01-01'  where stateid='2016-MN-043426'



####SECTION 5
##### move to uniquery

create table temp_deathsmain
select *
from deaths_main
where year(deathdate)='2016'

